import{_ as a,c as i,o as e,ag as n}from"./chunks/framework.BI3ie6Fx.js";const k=JSON.parse(`{"title":"How Core Works","description":"A deep dive into Core's architecture, startup process, and what makes it tick","frontmatter":{"title":"How Core Works","description":"A deep dive into Core's architecture, startup process, and what makes it tick"},"headers":[],"relativePath":"docs/how-core-works.md","filePath":"docs/how-core-works.md"}`),t={name:"docs/how-core-works.md"};function o(l,s,p,r,d,h){return e(),i("div",null,[...s[0]||(s[0]=[n(`<h1 id="how-core-works" tabindex="-1">How Core Works <a class="header-anchor" href="#how-core-works" aria-label="Permalink to &quot;How Core Works&quot;">â€‹</a></h1><p>This page takes you behind the scenes of Core. You&#39;ll learn exactly what happens when you start your bot, how the pieces fit together, andâ€”importantlyâ€”where Core shines and where it doesn&#39;t.</p><h2 id="the-30-second-version" tabindex="-1">The 30-Second Version <a class="header-anchor" href="#the-30-second-version" aria-label="Permalink to &quot;The 30-Second Version&quot;">â€‹</a></h2><p>Core is a modular framework for Discord.js bots. When you run your bot:</p><ol><li><strong>Environment loads</strong> â€” Config, database, and validation</li><li><strong>Intents gather</strong> â€” Core scans addons for required Discord intents</li><li><strong>Client creates</strong> â€” Discord.js client spins up with merged intents</li><li><strong>Discord connects</strong> â€” Authentication and gateway handshake</li><li><strong>Addons load</strong> â€” Your code runs, commands register</li><li><strong>Bot goes online</strong> â€” Ready to handle interactions</li></ol><p>That&#39;s it. No magic, no hidden complexity.</p><h2 id="the-startup-sequence-detailed" tabindex="-1">The Startup Sequence (Detailed) <a class="header-anchor" href="#the-startup-sequence-detailed" aria-label="Permalink to &quot;The Startup Sequence (Detailed)&quot;">â€‹</a></h2><p>When you run <code>npm start</code> or <code>npm run dev</code>, here&#39;s exactly what happens:</p><h3 id="phase-1-bootstrap-0-50ms-typical" tabindex="-1">Phase 1: Bootstrap (0-50ms typical) <a class="header-anchor" href="#phase-1-bootstrap-0-50ms-typical" aria-label="Permalink to &quot;Phase 1: Bootstrap (0-50ms typical)&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[info] Starting RiktigaTomten&#39;s Core...</span></span></code></pre></div><p>The entry point (<code>index.ts</code>) kicks off the boot sequence:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 1. Validate environment variables</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> missingVars</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> validateEnvironmentVariables</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (missingVars.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Fail fast with helpful error</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  process.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">exit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 2. Initialize database</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> initDatabases</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(db);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 3. Set up the bot</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> client</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> setupBot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><p>Core validates your <code>.env</code> file immediately. Missing <code>TOKEN</code>? You&#39;ll know in milliseconds, not after a cryptic Discord error.</p><h3 id="phase-2-intent-collection-10-30ms" tabindex="-1">Phase 2: Intent Collection (10-30ms) <a class="header-anchor" href="#phase-2-intent-collection-10-30ms" aria-label="Permalink to &quot;Phase 2: Intent Collection (10-30ms)&quot;">â€‹</a></h3><p>Before creating the Discord client, Core needs to know what intents to request. This happens in <code>setupBot()</code>:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[debug] Loading intent configurations...</span></span>
<span class="line"><span>[debug] Building intent configuration...</span></span></code></pre></div><p>Core scans every addon&#39;s <code>intents.js</code> file and merges them:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// From your addon</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> intents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  GatewayIntentBits.GuildMembers,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Your addon needs this</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Core collects these from ALL addons and merges them</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> allIntents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> buildIntents</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// No duplicates</span></span></code></pre></div><p><strong>Why this matters</strong>: Discord limits privileged intents. Core tracks which addon requested what, so when something breaks, you know where to look.</p><h3 id="phase-3-client-creation-5ms" tabindex="-1">Phase 3: Client Creation (&lt; 5ms) <a class="header-anchor" href="#phase-3-client-creation-5ms" aria-label="Permalink to &quot;Phase 3: Client Creation (&lt; 5ms)&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[debug] Creating Discord client with configured intents...</span></span>
<span class="line"><span>[info] Initializing interaction registry...</span></span></code></pre></div><p>The Discord.js client is created with the merged intents. At this point:</p><ul><li>Interaction handlers are set up (buttons, modals, select menus)</li><li>The command collection is initialized</li><li>Event listeners are attached</li></ul><p>The interaction registry is a key pieceâ€”it routes button clicks, modal submissions, and select menus to the right handler using pattern matching (exact, prefix, or regex).</p><h3 id="phase-4-discord-connection-300-1000ms" tabindex="-1">Phase 4: Discord Connection (300-1000ms) <a class="header-anchor" href="#phase-4-discord-connection-300-1000ms" aria-label="Permalink to &quot;Phase 4: Discord Connection (300-1000ms)&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[info] ğŸ” Connecting to Discord...</span></span></code></pre></div><p>This is the slowest partâ€”network latency to Discord&#39;s servers. Core measures this separately:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[debug] Timing breakdown: Local init 32ms | Discord handshake 1055ms</span></span></code></pre></div><p>If your bot is slow to start, it&#39;s almost always the Discord handshake, not Core.</p><h3 id="phase-5-ready-addon-loading" tabindex="-1">Phase 5: Ready &amp; Addon Loading <a class="header-anchor" href="#phase-5-ready-addon-loading" aria-label="Permalink to &quot;Phase 5: Ready &amp; Addon Loading&quot;">â€‹</a></h3><p>Once Discord says &quot;ready,&quot; the real work begins:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[success] Test Dev#6002 is now online and ready!</span></span>
<span class="line"><span>[info] Connected to Discord as: Test Dev#6002</span></span>
<span class="line"><span>[info] Serving 1 server(s) with 1 users</span></span>
<span class="line"><span>[info] Loading commands...</span></span>
<span class="line"><span>[info] Loading addons...</span></span></code></pre></div><p><strong>Commands load first</strong>, then addons. Why? Commands need to be registered with Discord before addon <code>onReady</code> hooks run, so addons can rely on commands being available.</p><p>Each addon/command is:</p><ol><li>Discovered by scanning for <code>addon.info</code> files</li><li>Grouped by priority (higher priorities load first)</li><li>Loaded in parallel within each priority group</li><li>Timed and logged (in debug mode)</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[debug] Loading priority 10 addon: Tickets</span></span>
<span class="line"><span>[debug] Loaded addon: Tickets v1.0.0 (23ms)</span></span></code></pre></div><h3 id="phase-6-banner-done" tabindex="-1">Phase 6: Banner &amp; Done <a class="header-anchor" href="#phase-6-banner-done" aria-label="Permalink to &quot;Phase 6: Banner &amp; Done&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  ______  ____  __  __  ______  ______ _   __</span></span>
<span class="line"><span> /_  __/ / __ \\/  |/  //_  __/ / ____// | / /</span></span>
<span class="line"><span>  / /   / / / / /|_/ /  / /   / __/  /  |/ / </span></span>
<span class="line"><span> / /   / /_/ / /  / /  / /   / /___ / /|  /  </span></span>
<span class="line"><span>/_/    \\____/_/  /_/  /_/   /_____//_/ |_/   </span></span>
<span class="line"><span></span></span>
<span class="line"><span>RiktigaTomten&#39;s Core</span></span>
<span class="line"><span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span class="line"><span>Core successfully initialized</span></span></code></pre></div><p>Your bot is now fully operational.</p><h2 id="how-logging-works" tabindex="-1">How Logging Works <a class="header-anchor" href="#how-logging-works" aria-label="Permalink to &quot;How Logging Works&quot;">â€‹</a></h2><p>Core&#39;s logger is straightforward but useful:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;General information&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// White</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Warning message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Yellow  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Error occurred&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, err);    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Red</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Verbose info&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Cyan (only when DEBUG=true)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Something worked!&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Green</span></span></code></pre></div><p>Every log line includes a timestamp formatted according to your <code>LOCALE</code> and <code>TIMEZONE</code> settings:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>23:31:48:[info] Loading addons...</span></span>
<span class="line"><span>23:31:48:[success] Bot fully loaded and ready in 802ms</span></span></code></pre></div><h3 id="debug-mode" tabindex="-1">Debug Mode <a class="header-anchor" href="#debug-mode" aria-label="Permalink to &quot;Debug Mode&quot;">â€‹</a></h3><p>Set <code>DEBUG=true</code> in your <code>.env</code> to see verbose logging:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[debug] Loading intent configurations...</span></span>
<span class="line"><span>[debug] Intent GUILD_MEMBERS requested by Welcome</span></span>
<span class="line"><span>[debug] Building intent configuration...</span></span>
<span class="line"><span>[debug] Creating Discord client with configured intents...</span></span>
<span class="line"><span>[debug] Loading priority 10 addon: Tickets v1.0.0</span></span>
<span class="line"><span>[debug] Addon initialization completed in 47ms</span></span></code></pre></div><p>This is invaluable for troubleshooting but noisy for production.</p><h2 id="how-addons-load" tabindex="-1">How Addons Load <a class="header-anchor" href="#how-addons-load" aria-label="Permalink to &quot;How Addons Load&quot;">â€‹</a></h2><p>The addon discovery system is recursive and priority-aware:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>addons/</span></span>
<span class="line"><span>â”œâ”€â”€ Tickets/              â†’ Priority 10, loads first</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ addon.info</span></span>
<span class="line"><span>â”‚   â””â”€â”€ extensions/</span></span>
<span class="line"><span>â”‚       â””â”€â”€ Logger/       â†’ Loads after parent</span></span>
<span class="line"><span>â””â”€â”€ Welcome/              â†’ Priority 0, loads after Tickets</span></span>
<span class="line"><span>    â””â”€â”€ addon.info</span></span></code></pre></div><h3 id="discovery-rules" tabindex="-1">Discovery Rules <a class="header-anchor" href="#discovery-rules" aria-label="Permalink to &quot;Discovery Rules&quot;">â€‹</a></h3><ol><li><strong>Recursive scan</strong> â€” Core finds all <code>addon.info</code> files, nested or not</li><li><strong>Validation</strong> â€” Each addon must have <code>addonfile</code> or <code>commandfile</code></li><li><strong>Priority sort</strong> â€” Higher priority numbers load first</li><li><strong>Parallel loading</strong> â€” Same-priority addons load simultaneously</li><li><strong>Timeout protection</strong> â€” Any addon taking &gt; 30 seconds fails gracefully</li></ol><h3 id="what-gets-skipped" tabindex="-1">What Gets Skipped <a class="header-anchor" href="#what-gets-skipped" aria-label="Permalink to &quot;What Gets Skipped&quot;">â€‹</a></h3><ul><li>Directories without <code>addon.info</code></li><li>Addons with <code>enabled: false</code></li><li>Invalid addon configurations (with a warning)</li><li><code>node_modules</code> and hidden directories</li></ul><h2 id="how-the-event-bus-works" tabindex="-1">How the Event Bus Works <a class="header-anchor" href="#how-the-event-bus-works" aria-label="Permalink to &quot;How the Event Bus Works&quot;">â€‹</a></h2><p>The <code>AddonBus</code> is how addons talk to each other without direct dependencies:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Addon A emits (use colon notation)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AddonBus.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">emitEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tickets:created&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { ticketId: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Addon B (or C, or D...) listens</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">AddonBus.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tickets:created&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // React to the event</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>Events are namespaced (<code>addonName:eventName</code>) to prevent collisions. The bus supports:</p><ul><li>Multiple listeners per event</li><li>One-time listeners (<code>onceEvent</code>)</li><li>Event statistics collection</li><li>Colon notation for clean, readable code</li></ul><h2 id="how-the-database-works" tabindex="-1">How the Database Works <a class="header-anchor" href="#how-the-database-works" aria-label="Permalink to &quot;How the Database Works&quot;">â€‹</a></h2><p>Core uses SQLite with <a href="https://github.com/WiseLibs/better-sqlite3" target="_blank" rel="noreferrer">better-sqlite3</a> for synchronous, fast queries:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Schemas are auto-discovered</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">addons</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">â””â”€â”€ MyAddon</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    â””â”€â”€ database</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        â””â”€â”€ schema.sql  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Core runs this automatically</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Then just query</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { db } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;#core&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> db.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SELECT * FROM users WHERE id = ?&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userId);</span></span></code></pre></div><h3 id="what-happens-at-startup" tabindex="-1">What Happens at Startup <a class="header-anchor" href="#what-happens-at-startup" aria-label="Permalink to &quot;What Happens at Startup&quot;">â€‹</a></h3><ol><li>Core loads <code>config/database.yaml</code> for settings</li><li>Database file is created if it doesn&#39;t exist</li><li>Pragmas are set (WAL mode, cache size, etc.)</li><li>All <code>*.sql</code> files in addon <code>database/</code> folders are executed</li><li>Connection pool is ready</li></ol><p>Queries are synchronous (better-sqlite3&#39;s design), which actually simplifies addon codeâ€”no async/await soup for simple lookups.</p><h2 id="how-interactions-route" tabindex="-1">How Interactions Route <a class="header-anchor" href="#how-interactions-route" aria-label="Permalink to &quot;How Interactions Route&quot;">â€‹</a></h2><p>When someone clicks a button or submits a modal, Core&#39;s <code>InteractionRegistry</code> handles routing:</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Register during addon load</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">client.interactions.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;button&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  customId: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ticket-close-*&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Wildcard matching</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  matchType: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;prefix&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  handler: handleTicketClose,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  priority: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  source: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Tickets&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>The registry supports:</p><table tabindex="0"><thead><tr><th>Match Type</th><th>Example</th><th>Matches</th></tr></thead><tbody><tr><td><code>exact</code></td><td><code>confirm-delete</code></td><td>Only <code>confirm-delete</code></td></tr><tr><td><code>prefix</code></td><td><code>ticket-</code></td><td><code>ticket-123</code>, <code>ticket-abc</code></td></tr><tr><td><code>regex</code></td><td><code>/order-\\d+/</code></td><td><code>order-1</code>, <code>order-999</code></td></tr></tbody></table><p>Higher priority handlers run first. If a handler returns <code>true</code>, processing stops.</p><hr><h2 id="what-core-does-well" tabindex="-1">What Core Does Well <a class="header-anchor" href="#what-core-does-well" aria-label="Permalink to &quot;What Core Does Well&quot;">â€‹</a></h2><p>Let&#39;s be honest about strengths:</p><h3 id="âœ…-fast-startup" tabindex="-1">âœ… Fast Startup <a class="header-anchor" href="#âœ…-fast-startup" aria-label="Permalink to &quot;âœ… Fast Startup&quot;">â€‹</a></h3><p>Local initialization is typically 30-80ms. The Discord handshake is what takes time, and that&#39;s not something any framework can optimize.</p><h3 id="âœ…-modular-by-default" tabindex="-1">âœ… Modular by Default <a class="header-anchor" href="#âœ…-modular-by-default" aria-label="Permalink to &quot;âœ… Modular by Default&quot;">â€‹</a></h3><p>Addons are truly isolated. You can drop in a ticket system from one project to another without modification.</p><h3 id="âœ…-developer-experience" tabindex="-1">âœ… Developer Experience <a class="header-anchor" href="#âœ…-developer-experience" aria-label="Permalink to &quot;âœ… Developer Experience&quot;">â€‹</a></h3><ul><li>Clear error messages</li><li>Debug mode for verbose logging</li><li>Timing breakdowns</li><li>Fail-fast validation</li></ul><h3 id="âœ…-no-lock-in" tabindex="-1">âœ… No Lock-in <a class="header-anchor" href="#âœ…-no-lock-in" aria-label="Permalink to &quot;âœ… No Lock-in&quot;">â€‹</a></h3><p>Core doesn&#39;t wrap Discord.js in abstractions. You get <code>client</code>, you use Discord.js methods directly. If Core disappeared tomorrow, refactoring wouldn&#39;t be a nightmare.</p><h3 id="âœ…-production-tested" tabindex="-1">âœ… Production-Tested <a class="header-anchor" href="#âœ…-production-tested" aria-label="Permalink to &quot;âœ… Production-Tested&quot;">â€‹</a></h3><p>Core came from real FiveM/Discord projects with real users. Rate limiting, error handling, and graceful degradation aren&#39;t afterthoughts.</p><hr><h2 id="what-core-doesn-t-do-well-honest-limitations" tabindex="-1">What Core Doesn&#39;t Do Well (Honest Limitations) <a class="header-anchor" href="#what-core-doesn-t-do-well-honest-limitations" aria-label="Permalink to &quot;What Core Doesn&#39;t Do Well (Honest Limitations)&quot;">â€‹</a></h2><p>Every framework has tradeoffs. Here&#39;s where Core falls short:</p><h3 id="âš ï¸-learning-curve-for-simple-bots" tabindex="-1">âš ï¸ Learning Curve for Simple Bots <a class="header-anchor" href="#âš ï¸-learning-curve-for-simple-bots" aria-label="Permalink to &quot;âš ï¸ Learning Curve for Simple Bots&quot;">â€‹</a></h3><p>If you just need a bot that responds to <code>/ping</code>, Core is overkill. The addon structure, <code>addon.info</code> files, and directory conventions add friction for trivial use cases.</p><p><strong>Who this affects</strong>: Beginners, one-off bots, simple utilities</p><h3 id="âš ï¸-sqlite-only-for-now" tabindex="-1">âš ï¸ SQLite Only (For Now) <a class="header-anchor" href="#âš ï¸-sqlite-only-for-now" aria-label="Permalink to &quot;âš ï¸ SQLite Only (For Now)&quot;">â€‹</a></h3><p>The database layer is built around SQLite. If you need PostgreSQL, MySQL, or MongoDB, you&#39;ll have to bring your own solution. The <code>db</code> export won&#39;t help you.</p><p><strong>Who this affects</strong>: Large-scale bots, existing database infrastructure, analytics-heavy projects</p><h3 id="âš ï¸-no-built-in-sharding" tabindex="-1">âš ï¸ No Built-in Sharding <a class="header-anchor" href="#âš ï¸-no-built-in-sharding" aria-label="Permalink to &quot;âš ï¸ No Built-in Sharding&quot;">â€‹</a></h3><p>Core doesn&#39;t handle sharding out of the box. For bots in 2,500+ servers, you&#39;ll need to implement sharding yourself using Discord.js&#39;s <code>ShardingManager</code>.</p><p><strong>Who this affects</strong>: Large bots approaching Discord&#39;s limits</p><h3 id="âš ï¸-limited-documentation" tabindex="-1">âš ï¸ Limited Documentation <a class="header-anchor" href="#âš ï¸-limited-documentation" aria-label="Permalink to &quot;âš ï¸ Limited Documentation&quot;">â€‹</a></h3><p>The docs you&#39;re reading are new. Edge cases, advanced patterns, and real-world examples are still being written.</p><p><strong>Who this affects</strong>: Everyone, honestly</p><h3 id="âš ï¸-single-developer-project" tabindex="-1">âš ï¸ Single Developer Project <a class="header-anchor" href="#âš ï¸-single-developer-project" aria-label="Permalink to &quot;âš ï¸ Single Developer Project&quot;">â€‹</a></h3><p>Core is primarily maintained by one person (RiktigaTomten). That means updates can be slow, and you might need to dig into the source code to understand something.</p><p><strong>Who this affects</strong>: Teams needing enterprise support, strict SLAs</p><h3 id="âš ï¸-no-gui-or-dashboard" tabindex="-1">âš ï¸ No GUI or Dashboard <a class="header-anchor" href="#âš ï¸-no-gui-or-dashboard" aria-label="Permalink to &quot;âš ï¸ No GUI or Dashboard&quot;">â€‹</a></h3><p>Core is code-only. If you want a web dashboard to configure your bot, you&#39;ll build it yourself. There&#39;s no admin panel, no config UI.</p><p><strong>Who this affects</strong>: Non-developers managing bots, visual configuration needs</p><hr><h2 id="when-to-use-core" tabindex="-1">When to Use Core <a class="header-anchor" href="#when-to-use-core" aria-label="Permalink to &quot;When to Use Core&quot;">â€‹</a></h2><p><strong>Core is for you if:</strong></p><ul><li>You build multiple Discord bots and want reusable components</li><li>You value clean architecture over quick hacks</li><li>You want TypeScript support with JavaScript addon flexibility</li><li>You&#39;re comfortable reading source code when docs fall short</li><li>You need a foundation, not a finished product</li></ul><p><strong>Core is NOT for you if:</strong></p><ul><li>You need a simple bot up in 5 minutes (use raw Discord.js)</li><li>You need enterprise support or SLAs</li><li>You require PostgreSQL/MySQL/MongoDB</li><li>You need sharding built-in for massive bots</li><li>You prefer heavy abstraction over direct Discord.js access</li></ul><hr><h2 id="architecture-diagram" tabindex="-1">Architecture Diagram <a class="header-anchor" href="#architecture-diagram" aria-label="Permalink to &quot;Architecture Diagram&quot;">â€‹</a></h2><p>Here&#39;s how the pieces connect:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>â”‚                         Your Bot                                 â”‚</span></span>
<span class="line"><span>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span></span>
<span class="line"><span>â”‚                                                                  â”‚</span></span>
<span class="line"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚</span></span>
<span class="line"><span>â”‚  â”‚   Addon A   â”‚  â”‚   Addon B   â”‚  â”‚   Addon C   â”‚   Addons     â”‚</span></span>
<span class="line"><span>â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚              â”‚</span></span>
<span class="line"><span>â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚</span></span>
<span class="line"><span>â”‚  â”‚ â”‚Extensionâ”‚ â”‚                                                 â”‚</span></span>
<span class="line"><span>â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                                 â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚</span></span>
<span class="line"><span>â”‚         â”‚              â”‚                â”‚                        â”‚</span></span>
<span class="line"><span>â”‚         â–¼              â–¼                â–¼                        â”‚</span></span>
<span class="line"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚</span></span>
<span class="line"><span>â”‚  â”‚                    Core Framework                     â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚                                                       â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚  â”‚ AddonBus â”‚ â”‚ Registry â”‚ â”‚ Database â”‚ â”‚ Logger  â”‚  â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚  â”‚  Events  â”‚ â”‚   API    â”‚ â”‚  SQLite  â”‚ â”‚         â”‚  â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚                                                       â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚  â”‚Interactionâ”‚ â”‚ Intent   â”‚ â”‚  Error   â”‚              â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚  â”‚ Registry â”‚ â”‚ Manager  â”‚ â”‚ Handler  â”‚              â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚</span></span>
<span class="line"><span>â”‚         â”‚                                                        â”‚</span></span>
<span class="line"><span>â”‚         â–¼                                                        â”‚</span></span>
<span class="line"><span>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚</span></span>
<span class="line"><span>â”‚  â”‚                   Discord.js Client                   â”‚       â”‚</span></span>
<span class="line"><span>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚</span></span>
<span class="line"><span>â”‚         â”‚                                                        â”‚</span></span>
<span class="line"><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span>
<span class="line"><span>          â”‚</span></span>
<span class="line"><span>          â–¼</span></span>
<span class="line"><span>    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span>
<span class="line"><span>    â”‚  Discord  â”‚</span></span>
<span class="line"><span>    â”‚    API    â”‚</span></span>
<span class="line"><span>    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span></code></pre></div><hr><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">â€‹</a></h2><p>Now that you understand how Core works:</p><ul><li><strong><a href="/corebot-docs/docs/getting-started">Getting Started</a></strong> â€” Set up your first Core project</li><li><strong><a href="/corebot-docs/docs/creating-addons">Creating Addons</a></strong> â€” Build your first addon</li><li><strong><a href="/corebot-docs/docs/addon-architecture">Addon Architecture</a></strong> â€” Deep dive into the addon system</li><li><strong><a href="/corebot-docs/reference/api">API Reference</a></strong> â€” Full API documentation</li></ul>`,120)])])}const g=a(t,[["render",o]]);export{k as __pageData,g as default};
